(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[981],{704:(e,t,a)=>{Promise.resolve().then(a.bind(a,3867))},3867:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var r=a(5155),s=a(9616),n=a(5236),l=a(2115),i=a(3473);let d=e=>{let{onAddProduct:t}=e,[a,s]=(0,l.useState)(""),[n,d]=(0,l.useState)("");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-base font-semibold",children:"Додати новий продукт"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a&&n&&(t({name:a,caloriesPer100g:parseInt(n)}),s(""),d(""))},className:"flex gap-2",children:[(0,r.jsxs)("label",{className:"form-control w-full max-w-xs flex-1",children:[(0,r.jsx)("div",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"Назва продукту"})}),(0,r.jsx)("input",{type:"text",placeholder:"Цільнозерновий хліб",className:"input input-sm input-bordered w-full max-w-xs text-base",value:a,onChange:e=>s(e.target.value)})]}),(0,r.jsxs)("label",{className:"form-controlmax-w-xs -mr-2",children:[(0,r.jsx)("div",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"Ккал на 100г"})}),(0,r.jsx)("input",{type:"number",placeholder:"244",className:"input input-sm input-bordered w-20 text-base",value:n,onChange:e=>d(e.target.value)})]}),(0,r.jsxs)("label",{className:"form-control max-w-xs",children:[(0,r.jsx)("div",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"⠀"})}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary btn-sm",children:(0,r.jsx)(i.A,{className:"h-5 w-5"})})]})]})]})};var c=a(2423);let o=e=>{let{currentGoal:t,onSetGoal:a,goalHistory:s}=e,[n,i]=(0,l.useState)(""),d=async e=>{if(e.preventDefault(),n)try{await a(Number(n)),i("")}catch(e){console.error("Error setting goal:",e)}},o=e=>new Date(e).toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"card-title text-base",children:"Ціль калорій"}),(0,r.jsx)("div",{className:"text-base",children:t?"".concat(t," ккал"):"Не встановлено"})]}),(0,r.jsxs)("form",{onSubmit:d,className:"mt-4 flex gap-2",children:[(0,r.jsx)("input",{type:"number",placeholder:"Нова ціль (ккал)",className:"input input-sm input-bordered flex-1 text-base",value:n,onChange:e=>i(e.target.value)}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary btn-sm",children:"Зберегти"})]}),s.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"divider",children:"Історія змін"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md bg-base-200 px-2 py-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:o(e.startDate)})]}),(0,r.jsxs)("span",{className:"font-medium",children:[e.value," ккал"]})]},t))})]})]})};var u=a(5686),m=a(6030);let x={id:"",name:"",caloriesPer100g:0,userId:"",createdAt:""},f=e=>{var t;let{products:a,onDeleteProduct:s}=e,[n,i]=(0,l.useState)({isOpen:!1,product:x}),d=e=>{i({isOpen:!0,product:e})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md bg-base-200 px-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsxs)("span",{className:"text-sm text-base-content/70",children:[" ","• ",e.caloriesPer100g," ккал/100г"]})]}),(0,r.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>d(e),children:(0,r.jsx)(u.A,{size:16})})]},e.id))}),(0,r.jsx)(m.R,{isOpen:n.isOpen,onConfirm:()=>{n.product&&(s(n.product.id),i({isOpen:!1,product:x}))},onCancel:()=>i({isOpen:!1,product:x}),itemName:null===(t=n.product)||void 0===t?void 0:t.name})]})};var p=a(3312),g=a(9749),h=a(1125),b=a(1567);let v=h.bL,j=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(h.B8,{ref:t,className:(0,b.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...s})});j.displayName=h.B8.displayName;let y=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(h.l9,{ref:t,className:(0,b.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...s})});y.displayName=h.l9.displayName;let N=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(h.UC,{ref:t,className:(0,b.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});N.displayName=h.UC.displayName;var w=a(9223),S=a(6498);let k=()=>{let{user:e,logout:t}=(0,s.Z)(),{goalHistory:a,currentGoal:l,setNewGoal:i,loading:c}=(0,w.l)(null==e?void 0:e.uid),{products:u,addProduct:m,deleteProduct:x,loading:h}=(0,S.Q)(null==e?void 0:e.uid);return h||c?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsx)("span",{className:"loading loading-ring loading-lg"})}):(0,r.jsxs)("div",{className:"min-h-screen pb-20",children:[(0,r.jsx)("div",{className:"bg-background shadow-sm",children:(0,r.jsxs)("div",{className:"mx-auto flex max-w-xl items-center justify-between px-4 py-2",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold",children:"Налаштування"}),(0,r.jsxs)(p.$,{onClick:t,size:"sm",variant:"ghost",children:[(0,r.jsx)(n.A,{size:16})," Вийти"]})]})}),(0,r.jsx)("div",{className:"mx-auto max-w-xl px-4 py-4",children:(0,r.jsxs)(v,{defaultValue:"products",children:[(0,r.jsxs)(j,{className:"mb-4 w-full",children:[(0,r.jsx)(y,{value:"products",className:"flex-1",children:"Мої продукти"}),(0,r.jsx)(y,{value:"goals",className:"flex-1",children:"Цілі"})]}),(0,r.jsx)(N,{value:"products",children:(0,r.jsx)(g.Zp,{children:(0,r.jsxs)(g.Wu,{children:[(0,r.jsx)(d,{onAddProduct:m}),(0,r.jsx)("div",{className:"divider",children:"Мої продукти"}),(0,r.jsx)(f,{products:u,onDeleteProduct:x})]})})}),(0,r.jsx)(N,{value:"goals",children:(0,r.jsx)(g.Zp,{children:(0,r.jsx)(g.Wu,{children:(0,r.jsx)(o,{currentGoal:l,onSetGoal:i,goalHistory:a})})})})]})})]})}},6030:(e,t,a)=>{"use strict";a.d(t,{R:()=>s});var r=a(5155);let s=e=>{let{isOpen:t,onConfirm:a,onCancel:s,itemName:n}=e;return t?(0,r.jsxs)("div",{className:"modal modal-open rounded-box",children:[(0,r.jsxs)("div",{className:"modal-box",children:[(0,r.jsx)("h3",{className:"text-lg font-bold",children:"Підтвердження видалення"}),(0,r.jsxs)("p",{className:"py-4",children:["Ви впевнені, що хочете видалити ",n,"?"]}),(0,r.jsxs)("div",{className:"modal-action",children:[(0,r.jsx)("button",{className:"btn",onClick:s,children:"Скасувати"}),(0,r.jsx)("button",{className:"btn btn-error",onClick:a,children:"Видалити"})]})]}),(0,r.jsx)("div",{className:"modal-backdrop",onClick:s})]}):null}},3312:(e,t,a)=>{"use strict";a.d(t,{$:()=>c});var r=a(5155),s=a(2317),n=a(1027),l=a(2115),i=a(1567);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,t)=>{let{className:a,variant:n,size:l,asChild:c=!1,...o}=e,u=c?s.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(d({variant:n,size:l,className:a})),ref:t,...o})});c.displayName="Button"},9749:(e,t,a)=>{"use strict";a.d(t,{Wu:()=>i,Zp:()=>l});var r=a(5155),s=a(2115),n=a(1567);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...s})});l.displayName="Card",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-4",a),...s})});i.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-4",a),...s})}).displayName="CardFooter"},6060:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(399),s=a(2115),n=a(4595);let l=()=>{let[e,t]=(0,s.useState)(null),[a,l]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=(0,r.hg)(n.j,e=>{t(e),l(!1)});return()=>e()},[]),{user:e,loading:a,signInWithGoogle:async()=>{try{return(await (0,r.df)(n.j,n.h)).user}catch(e){throw console.error("Error signing in with Google:",e),e}},logout:()=>(0,r.CI)(n.j)}}},9223:(e,t,a)=>{"use strict";a.d(t,{l:()=>o});var r=a(7058),s=a(2115),n=a(4595);let l="calorieGoals",i="userProfiles",d=e=>{let t=localStorage.getItem(e);return t?JSON.parse(t):null},c=(e,t,a)=>{localStorage.setItem(e,JSON.stringify({data:t,lastUpdate:a}))},o=e=>{let[t,a]=(0,s.useState)([]),[o,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!0),[f,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!e)return;let t=!0;return(async()=>{try{let s="goalHistory_".concat(e),i=d(s);if(i&&t){a(i.data),x(!1);let t=(0,r.P)((0,r.rJ)(n.db,l),(0,r._M)("userId","==",e),(0,r._M)("createdAt",">",i.lastUpdate),(0,r.My)("createdAt","desc"));if((await (0,r.GG)(t)).empty)return}let o=(0,r.P)((0,r.rJ)(n.db,l),(0,r._M)("userId","==",e),(0,r.My)("startDate","desc")),u=(await (0,r.GG)(o)).docs.map(e=>({id:e.id,...e.data()}));if(t){let e=new Date().toISOString();c(s,u,e),a(u),x(!1)}}catch(e){console.error("Error loading goal history:",e),t&&(p(e),x(!1))}})(),()=>{t=!1}},[e]),(0,s.useEffect)(()=>{if(!e)return;let t=!0;return(async()=>{try{let a="currentGoal_".concat(e),s=d(a);s&&u(s.data);let l=(0,r.H9)(n.db,i,e),o=await (0,r.x7)(l);if(o.exists()&&t){let e=o.data(),t=new Date().toISOString();c(a,e.currentGoal,t),u(e.currentGoal)}}catch(e){console.error("Error loading current goal:",e),t&&p(e)}})(),()=>{t=!1}},[e]);let g=async s=>{if(!e)return;let d=[...t];try{let d={userId:e,value:s,startDate:new Date().toISOString(),createdAt:new Date().toISOString()};u(s),a(e=>[{...d,id:"temp"},...e]),await (0,r.gS)((0,r.rJ)(n.db,l),d),await (0,r.BN)((0,r.H9)(n.db,i,e),{userId:e,currentGoal:s,lastUpdated:new Date().toISOString()},{merge:!0});let o=new Date().toISOString();c("goalHistory_".concat(e),t,o),c("currentGoal_".concat(e),s,o)}catch(e){throw a(d),u(o),console.error("Error setting new goal:",e),p(e),e}};return{goalHistory:t,currentGoal:o,loading:m,error:f,setNewGoal:g}}},6498:(e,t,a)=>{"use strict";a.d(t,{Q:()=>i});var r=a(7058),s=a(2115),n=a(4595);let l="products",i=e=>{let[t,a]=(0,s.useState)([]),[i,d]=(0,s.useState)(!0),[c,o]=(0,s.useState)({key:"products_".concat(e),lastUpdate:""});(0,s.useEffect)(()=>{e&&(async()=>{let t="products_".concat(e),s=localStorage.getItem(t);if(s){let{data:i,lastUpdate:c}=JSON.parse(s);a(i),d(!1),o({key:t,lastUpdate:c});let u=(0,r.P)((0,r.rJ)(n.db,l),(0,r._M)("userId","==",e),(0,r._M)("createdAt",">",c),(0,r.My)("createdAt","desc"));if((await (0,r.GG)(u)).empty)return}let i=(0,r.P)((0,r.rJ)(n.db,l),(0,r._M)("userId","==",e),(0,r.My)("createdAt","desc")),c=(await (0,r.GG)(i)).docs.map(e=>({id:e.id,...e.data()})),u=new Date().toISOString();localStorage.setItem(t,JSON.stringify({data:c,lastUpdate:u})),o({key:t,lastUpdate:u}),a(c),d(!1)})()},[e]);let u=async s=>{try{let i=await (0,r.gS)((0,r.rJ)(n.db,l),{...s,userId:e,createdAt:new Date().toISOString()}),d=await (0,r.x7)(i),o={id:d.id,...d.data()},u=[o,...t];return a(u),localStorage.setItem(c.key,JSON.stringify({data:u,lastUpdate:c.lastUpdate})),o}catch(e){throw console.error("Error adding product:",e),e}},m=async e=>{try{await (0,r.kd)((0,r.H9)(n.db,l,e));let s=t.filter(t=>t.id!==e);a(s),localStorage.setItem(c.key,JSON.stringify({data:s,lastUpdate:c.lastUpdate}))}catch(e){throw console.error("Error deleting product:",e),e}};return{products:t,loading:i,addProduct:u,deleteProduct:m}}},4595:(e,t,a)=>{"use strict";a.d(t,{db:()=>c,h:()=>d,j:()=>i});var r=a(9904),s=a(399),n=a(7058);let l=(0,r.Wp)({apiKey:"AIzaSyCFQPz1JQSGn8M2QdVkxA8tWqQvQT0QYcA",authDomain:"tracking-kcal.firebaseapp.com",projectId:"tracking-kcal",storageBucket:"tracking-kcal.firebasestorage.app",messagingSenderId:"959211134233",appId:"1:959211134233:web:621d0a43eeeb642a347988"}),i=(0,s.xI)(l),d=new s.HF,c=(0,n.aU)(l)},1567:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(3463),s=a(9795);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},9616:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>i,Z:()=>d});var r=a(5155),s=a(2115),n=a(6060);let l=(0,s.createContext)(null),i=e=>{let{children:t}=e,a=(0,n.A)();return(0,r.jsx)(l.Provider,{value:a,children:t})},d=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,882,459,172,440,441,517,358],()=>t(704)),_N_E=e.O()}]);