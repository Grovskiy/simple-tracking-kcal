(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[560],{5941:(e,t,s)=>{Promise.resolve().then(s.bind(s,1482))},1482:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(5155),r=s(9616);let n=()=>new Date().toISOString().split("T")[0];var i=s(2115),d=s(3473),l=s(8299),o=s(1027),c=s(767),u=s(1567);let m=l.bL,x=l.l9;l.bm;let g=l.ZL,h=i.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});h.displayName=l.hJ.displayName;let p=(0,o.F)("fixed z-50 gap-4 bg-background p-2 md:p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=i.forwardRef((e,t)=>{let{side:s="right",className:r,children:n,...i}=e;return(0,a.jsxs)(g,{children:[(0,a.jsx)(h,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,u.cn)(p({side:s}),r),...i,children:[(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}),n]})]})});f.displayName=l.UC.displayName;let b=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};b.displayName="SheetHeader";let j=i.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,u.cn)("text-lg font-semibold text-foreground",s),...r})});j.displayName=l.hE.displayName;let v=i.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,u.cn)("text-sm text-muted-foreground",s),...r})});v.displayName=l.VY.displayName;let N=e=>{let{products:t,onAddEntry:s,selectedDate:r}=e,[n,l]=(0,i.useState)(""),[o,c]=(0,i.useState)(""),[u,g]=(0,i.useState)(!1);return(0,a.jsxs)(m,{open:u,onOpenChange:g,children:[(0,a.jsx)(x,{asChild:!0,children:(0,a.jsx)("button",{className:"fixed bottom-20 right-6 flex h-14 w-14 items-center justify-center rounded-full bg-indigo-600 shadow-lg transition-colors hover:bg-indigo-700",children:(0,a.jsx)(d.A,{className:"h-6 w-6 text-white"})})}),(0,a.jsxs)(f,{side:"bottom",children:[(0,a.jsxs)(b,{children:[(0,a.jsx)(j,{children:"Додати спожиту їжу"}),(0,a.jsx)(v,{children:'Додайте продукти до свого щоденника. Натисніть "+" після завершення.'}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),n&&o){let e=t.find(e=>e.id===n);if(!e)return;let a=Math.round(e.caloriesPer100g*parseInt(o)/100);s({productId:n,grams:parseInt(o),date:r,productName:e.name,calories:a}),l(""),c(""),g(!1)}},className:"flex gap-2",children:[(0,a.jsxs)("select",{className:"select select-bordered select-sm w-full max-w-xs flex-1 text-base",value:n,onChange:e=>l(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Виберіть продукт"}),t.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.caloriesPer100g," ккал/100г)"]},e.id))]}),(0,a.jsx)("input",{type:"number",placeholder:"Грам",className:"input input-sm input-bordered w-20 text-base",value:o,onChange:e=>c(e.target.value)}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary btn-sm",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})})]})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsx)("div",{className:"grid grid-cols-4 items-center gap-4"})})]})]})};var y=s(5686),w=s(9223),S=s(6030),k=s(9749);let C={id:"",productId:"",productName:"",grams:0,calories:0,date:"",userId:"",createdAt:""},A=e=>{var t,s;let{entries:n,onDeleteEntry:d}=e,[l,o]=(0,i.useState)({isOpen:!1,entry:C}),{user:c}=(0,r.Z)(),{currentGoal:u,loading:m}=(0,w.l)(null==c?void 0:c.uid),x=n.reduce((e,t)=>e+t.calories,0),g=u?u-x:0,h=Math.min(x/(u||0)*100,100),p=g>=0?{bar:"bg-primary",text:"text-primary"}:80>=Math.abs(g)?{bar:"bg-warning",text:"text-warning"}:{bar:"bg-error",text:"text-error"},f=g>=0?{bar:"progress-primary",text:"text-primary"}:80>=Math.abs(g)?{bar:"progress-warning",text:"text-warning"}:{bar:"progress-error",text:"text-error"},b=e=>{o({isOpen:!0,entry:e})};return m?(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("span",{className:"loading loading-ring loading-lg"})}):(0,a.jsxs)("div",{children:[(0,a.jsx)(k.Zp,{className:"mb-4",children:(0,a.jsxs)(k.Wu,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-lg font-medium",children:"Прогрес"}),(0,a.jsxs)("span",{className:"text-lg font-medium",children:[" ",m?(0,a.jsx)("span",{className:"loading loading-ring loading-xs mr-1"}):Math.round(h),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("progress",{className:"progress ".concat(f.bar),value:m?void 0:h,max:"100"}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Спожито"}),(0,a.jsxs)("p",{className:"font-medium",children:[x," ккал"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Залишилось"}),(0,a.jsx)("p",{className:"font-medium",children:(0,a.jsxs)("span",{className:p.text,children:[m?(0,a.jsx)("span",{className:"loading loading-ring loading-xs"}):Math.abs(g)," ","ккал",g>=0?"":80>=Math.abs(g)?" трохи перевищено":" перевищено"]})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Ціль"}),(0,a.jsxs)("p",{className:"font-medium",children:[u," ккал"]})]})]})]})]})}),(0,a.jsx)(k.Zp,{children:(0,a.jsxs)(k.Wu,{children:[(0,a.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-base-200 px-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.productName}),(0,a.jsxs)("span",{className:"text-sm text-base-content/70",children:[" • ",e.grams,"г"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[e.calories," ккал"]}),(0,a.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>b(e),children:(0,a.jsx)(y.A,{size:16})})]})]},e.id))}),(0,a.jsx)(S.R,{isOpen:l.isOpen,onConfirm:()=>{l.entry&&(d(l.entry.id),o({isOpen:!1,entry:C}))},onCancel:()=>o({isOpen:!1,entry:C}),itemName:"".concat(null===(t=l.entry)||void 0===t?void 0:t.productName," (").concat(null===(s=l.entry)||void 0===s?void 0:s.grams,"г)")})]})})]})},D=e=>new Date(e).toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"});var E=s(3518),I=s(2423),P=s(6967),O=s(3312);let Q=(e,t)=>{let s=new Date(e);return s.setDate(s.getDate()+t),s.toISOString().split("T")[0]},R=e=>{let{date:t,onDateChange:s}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)(O.$,{onClick:()=>s(Q(t,-1)),variant:"ghost",children:(0,a.jsx)(E.A,{className:"!size-5"})}),(0,a.jsxs)(O.$,{onClick:()=>s(n()),variant:"ghost",className:"text-base",children:[(0,a.jsx)(I.A,{size:16}),D(t)]}),(0,a.jsx)(O.$,{onClick:()=>s(Q(t,1)),variant:"ghost",children:(0,a.jsx)(P.A,{className:"!size-5"})})]})},M=e=>{let{products:t,entries:s,onAddEntry:r,onDeleteEntry:d}=e,[l,o]=(0,i.useState)(n()),c=s.filter(e=>e.date===l);return(0,a.jsxs)("div",{className:"min-h-screen pb-28",children:[(0,a.jsx)("div",{className:"bg-background shadow-sm",children:(0,a.jsx)("div",{className:"mx-auto max-w-xl px-4 py-2",children:(0,a.jsx)(R,{date:l,onDateChange:o})})}),(0,a.jsx)("div",{className:"mx-auto max-w-xl px-4 py-4",children:(0,a.jsx)(A,{entries:c,onDeleteEntry:d})}),(0,a.jsx)(N,{products:t,onAddEntry:r,selectedDate:l})]})};var _=s(7058),z=s(4595);let J=e=>{let[t,s]=(0,i.useState)([]),[a,r]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{if(!e)return;let t=(0,_.P)((0,_.rJ)(z.db,"entries"),(0,_._M)("userId","==",e)),a=(0,_.aQ)(t,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),s(t),r(!1)});return()=>a()},[e]),{entries:t,loading:a,addEntry:async t=>{try{await (0,_.gS)((0,_.rJ)(z.db,"entries"),{...t,userId:e,createdAt:new Date().toISOString()})}catch(e){throw console.error("Error adding entry:",e),e}},deleteEntry:async e=>{try{await (0,_.kd)((0,_.H9)(z.db,"entries",e))}catch(e){throw console.error("Error deleting entry:",e),e}}}};var G=s(6498);function T(){let{user:e}=(0,r.Z)(),{products:t,addProduct:s,deleteProduct:n,loading:i}=(0,G.Q)(null==e?void 0:e.uid),{entries:d,addEntry:l,deleteEntry:o,loading:c}=J(null==e?void 0:e.uid);return i||c?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("span",{className:"loading loading-ring loading-lg"})}):(0,a.jsx)(M,{products:t,entries:d,onAddProduct:s,onAddEntry:l,onDeleteProduct:n,onDeleteEntry:o})}},6030:(e,t,s)=>{"use strict";s.d(t,{R:()=>r});var a=s(5155);let r=e=>{let{isOpen:t,onConfirm:s,onCancel:r,itemName:n}=e;return t?(0,a.jsxs)("div",{className:"modal modal-open rounded-box",children:[(0,a.jsxs)("div",{className:"modal-box",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Підтвердження видалення"}),(0,a.jsxs)("p",{className:"py-4",children:["Ви впевнені, що хочете видалити ",n,"?"]}),(0,a.jsxs)("div",{className:"modal-action",children:[(0,a.jsx)("button",{className:"btn",onClick:r,children:"Скасувати"}),(0,a.jsx)("button",{className:"btn btn-error",onClick:s,children:"Видалити"})]})]}),(0,a.jsx)("div",{className:"modal-backdrop",onClick:r})]}):null}},3312:(e,t,s)=>{"use strict";s.d(t,{$:()=>o});var a=s(5155),r=s(2317),n=s(1027),i=s(2115),d=s(1567);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=i.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:o=!1,...c}=e,u=o?r.DX:"button";return(0,a.jsx)(u,{className:(0,d.cn)(l({variant:n,size:i,className:s})),ref:t,...c})});o.displayName="Button"},9749:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>d,Zp:()=>i});var a=s(5155),r=s(2115),n=s(1567);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});i.displayName="Card",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})}).displayName="CardHeader",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",s),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-4",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-4",s),...r})}).displayName="CardFooter"},6060:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(399),r=s(2115),n=s(4595);let i=()=>{let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=(0,a.hg)(n.j,e=>{t(e),i(!1)});return()=>e()},[]),{user:e,loading:s,signInWithGoogle:async()=>{try{return(await (0,a.df)(n.j,n.h)).user}catch(e){throw console.error("Error signing in with Google:",e),e}},logout:()=>(0,a.CI)(n.j)}}},9223:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var a=s(7058),r=s(2115),n=s(4595);let i=e=>{let[t,s]=(0,r.useState)([]),[i,d]=(0,r.useState)(null),[l,o]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!e)return;let t=(0,a.P)((0,a.rJ)(n.db,"calorieGoals"),(0,a._M)("userId","==",e),(0,a.My)("startDate","desc")),r=(0,a.aQ)(t,e=>{s(e.docs.map(e=>({id:e.id,...e.data()}))),o(!1)});return()=>r()},[e]),(0,r.useEffect)(()=>{if(!e)return;let t=(0,a.H9)(n.db,"userProfiles",e),s=(0,a.aQ)(t,e=>{e.exists()&&d(e.data().currentGoal)});return()=>s()},[e]),{goalHistory:t,currentGoal:i,setNewGoal:async t=>{if(e)try{await (0,a.gS)((0,a.rJ)(n.db,"calorieGoals"),{userId:e,value:t,startDate:new Date().toISOString(),createdAt:new Date().toISOString()}),await (0,a.BN)((0,a.H9)(n.db,"userProfiles",e),{userId:e,currentGoal:t,lastUpdated:new Date().toISOString()},{merge:!0})}catch(e){throw console.error("Error setting new goal:",e),e}},loading:l}}},6498:(e,t,s)=>{"use strict";s.d(t,{Q:()=>i});var a=s(7058),r=s(2115),n=s(4595);let i=e=>{let[t,s]=(0,r.useState)([]),[i,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!e)return;let t=(0,a.P)((0,a.rJ)(n.db,"products"),(0,a._M)("userId","==",e)),r=(0,a.aQ)(t,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),s(t),d(!1)});return()=>r()},[e]),{products:t,loading:i,addProduct:async t=>{try{await (0,a.gS)((0,a.rJ)(n.db,"products"),{...t,userId:e,createdAt:new Date().toISOString()})}catch(e){throw console.error("Error adding product:",e),e}},deleteProduct:async e=>{try{await (0,a.kd)((0,a.H9)(n.db,"products",e))}catch(e){throw console.error("Error deleting product:",e),e}}}}},4595:(e,t,s)=>{"use strict";s.d(t,{db:()=>o,h:()=>l,j:()=>d});var a=s(9904),r=s(399),n=s(7058);let i=(0,a.Wp)({apiKey:"AIzaSyCFQPz1JQSGn8M2QdVkxA8tWqQvQT0QYcA",authDomain:"tracking-kcal.firebaseapp.com",projectId:"tracking-kcal",storageBucket:"tracking-kcal.firebasestorage.app",messagingSenderId:"959211134233",appId:"1:959211134233:web:621d0a43eeeb642a347988"}),d=(0,r.xI)(i),l=new r.HF,o=(0,n.aU)(i)},1567:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var a=s(3463),r=s(9795);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},9616:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>d,Z:()=>l});var a=s(5155),r=s(2115),n=s(6060);let i=(0,r.createContext)(null),d=e=>{let{children:t}=e,s=(0,n.A)();return(0,a.jsx)(i.Provider,{value:s,children:t})},l=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,882,459,172,748,441,517,358],()=>t(5941)),_N_E=e.O()}]);