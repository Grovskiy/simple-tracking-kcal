(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2785:(e,t,s)=>{Promise.resolve().then(s.bind(s,5480))},7401:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:d="",children:o,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:s,strokeWidth:i?24*Number(c)/Number(a):c,className:n("lucide",d),...m},[...u.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(o)?o:[o]])}),i=(e,t)=>{let s=(0,r.forwardRef)((s,l)=>{let{className:i,...d}=s;return(0,r.createElement)(c,{ref:l,iconNode:t,className:n("lucide-".concat(a(e)),i),...d})});return s.displayName="".concat(e),s}},4505:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7401).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6046:(e,t,s)=>{"use strict";var r=s(6658);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},5480:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>D});var r=s(5155),a=s(2115);let n=e=>new Date(e).toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"});var l=s(7401);let c=(0,l.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),i=e=>{let{isOpen:t,onConfirm:s,onCancel:a,itemName:n}=e;return t?(0,r.jsxs)("div",{className:"modal modal-open",children:[(0,r.jsxs)("div",{className:"modal-box",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",children:"Підтвердження видалення"}),(0,r.jsxs)("p",{className:"py-4",children:["Ви впевнені, що хочете видалити ",n,"?"]}),(0,r.jsxs)("div",{className:"modal-action",children:[(0,r.jsx)("button",{className:"btn",onClick:a,children:"Скасувати"}),(0,r.jsx)("button",{className:"btn btn-error",onClick:s,children:"Видалити"})]})]}),(0,r.jsx)("div",{className:"modal-backdrop",onClick:a})]}):null},d={id:"",productId:"",productName:"",grams:0,calories:0,date:"",userId:"",createdAt:""},o=e=>{var t,s;let{entries:l,date:o,onDeleteEntry:u}=e,[m,h]=(0,a.useState)({isOpen:!1,entry:d}),x=l.reduce((e,t)=>e+t.calories,0),p=e=>{h({isOpen:!0,entry:e})};return(0,r.jsx)("div",{className:"card card-compact bg-base-100 shadow-xl",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"card-title text-base",children:n(o)}),(0,r.jsxs)("div",{className:"text-lg font-bold",children:[x," ккал"]})]}),(0,r.jsx)("div",{className:"divider my-2"}),(0,r.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center px-2 bg-base-200 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:e.productName}),(0,r.jsxs)("span",{className:"text-sm text-base-content/70",children:[" • ",e.grams,"г"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.calories," ккал"]}),(0,r.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>p(e),children:(0,r.jsx)(c,{size:16})})]})]},e.id))}),(0,r.jsx)(i,{isOpen:m.isOpen,onConfirm:()=>{m.entry&&(u(m.entry.id),h({isOpen:!1,entry:d}))},onCancel:()=>h({isOpen:!1,entry:d}),itemName:"".concat(null===(t=m.entry)||void 0===t?void 0:t.productName," (").concat(null===(s=m.entry)||void 0===s?void 0:s.grams,"г)")})]})})},u={id:"",name:"",caloriesPer100g:0,userId:"",createdAt:""},m=e=>{var t;let{products:s,onDeleteProduct:n}=e,[l,d]=(0,a.useState)({isOpen:!1,product:u}),o=e=>{d({isOpen:!0,product:e})};return(0,r.jsx)("div",{className:"card card-compact bg-base-100 shadow-xl",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsx)("h2",{className:"card-title text-base",children:"Мої продукти"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center px-2 bg-base-200 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsxs)("span",{className:"text-sm text-base-content/70",children:[" • ",e.caloriesPer100g," ккал/100г"]})]}),(0,r.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>o(e),children:(0,r.jsx)(c,{size:16})})]},e.id))}),(0,r.jsx)(i,{isOpen:l.isOpen,onConfirm:()=>{l.product&&(n(l.product.id),d({isOpen:!1,product:u}))},onCancel:()=>d({isOpen:!1,product:u}),itemName:null===(t=l.product)||void 0===t?void 0:t.name})]})})},h=()=>new Date().toISOString().split("T")[0],x=(0,l.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),p=e=>{let{products:t,onAddEntry:s,selectedDate:n}=e,[l,c]=(0,a.useState)(""),[i,d]=(0,a.useState)("");return(0,r.jsx)("div",{className:"card card-compact bg-base-100 shadow-xl",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsx)("h2",{className:"card-title text-base",children:"Додати спожиту їжу"}),(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),l&&i){let e=t.find(e=>e.id===l);if(!e)return;let r=Math.round(e.caloriesPer100g*parseInt(i)/100);s({productId:l,grams:parseInt(i),date:n,productName:e.name,calories:r}),c(""),d("")}},className:"flex gap-2",children:[(0,r.jsxs)("select",{className:"select select-sm select-bordered flex-1 w-full max-w-xs",value:l,onChange:e=>c(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Виберіть продукт"}),t.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.caloriesPer100g," ккал/100г)"]},e.id))]}),(0,r.jsx)("input",{type:"number",placeholder:"Грам",className:"input input-sm input-bordered w-32",value:i,onChange:e=>d(e.target.value)}),(0,r.jsx)("button",{type:"submit",className:"btn btn-sm btn-primary",children:(0,r.jsx)(x,{className:"w-5 h-5"})})]})]})})},b=(0,l.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),j=(0,l.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),y=(0,l.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),v=(e,t)=>{let s=new Date(e);return s.setDate(s.getDate()+t),s.toISOString().split("T")[0]},g=e=>{let{date:t,onDateChange:s}=e;return(0,r.jsxs)("div",{className:"flex justify-center items-center gap-4 my-4",children:[(0,r.jsx)("button",{className:"btn btn-sm btn-neutral btn-outline btn-circle",onClick:()=>s(v(t,-1)),children:(0,r.jsx)(b,{className:"w-5 h-5"})}),(0,r.jsxs)("button",{className:"btn btn-sm btn-neutral btn-outline btn-ghost gap-2",onClick:()=>s(h()),children:[(0,r.jsx)(j,{className:"w-5 h-5"}),n(t)]}),(0,r.jsx)("button",{className:"btn btn-sm btn-neutral btn-outline btn-circle",onClick:()=>s(v(t,1)),children:(0,r.jsx)(y,{className:"w-5 h-5"})})]})},N=e=>{let{onAddProduct:t}=e,[s,n]=(0,a.useState)(""),[l,c]=(0,a.useState)("");return(0,r.jsx)("div",{className:"card card-compact bg-base-100 shadow-xl",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsx)("h2",{className:"card-title text-base",children:"Додати новий продукт"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s&&l&&(t({name:s,caloriesPer100g:parseInt(l)}),n(""),c(""))},className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"Назва продукту",className:"input input-sm input-bordered flex-1 w-full max-w-xs",value:s,onChange:e=>n(e.target.value)}),(0,r.jsx)("input",{type:"number",placeholder:"Ккал на 100г",className:"input input-sm input-bordered w-28",value:l,onChange:e=>c(e.target.value)}),(0,r.jsx)("button",{type:"submit",className:"btn btn-sm btn-primary",children:(0,r.jsx)(x,{className:"w-5 h-5"})})]})]})})},f=e=>{let{products:t,entries:s,onAddProduct:n,onAddEntry:l,onDeleteProduct:c,onDeleteEntry:i}=e,[d,u]=(0,a.useState)(h()),x=s.filter(e=>e.date===d);return(0,r.jsxs)("div",{className:"max-w-lg mx-auto p-4",children:[(0,r.jsx)(N,{onAddProduct:n}),(0,r.jsx)(g,{date:d,onDateChange:u}),(0,r.jsx)(p,{products:t,onAddEntry:l,selectedDate:d}),(0,r.jsx)("div",{className:"my-4",children:(0,r.jsx)(m,{products:t,onDeleteProduct:c})}),(0,r.jsx)("div",{className:"my-4",children:(0,r.jsx)(o,{entries:x,date:d,onDeleteEntry:i})})]})};var w=s(6046),k=s(9616),C=s(4505);let A=e=>{let{children:t}=e,{user:s,loading:n}=(0,k.Z)(),l=(0,w.useRouter)();return((0,a.useEffect)(()=>{n||s||l.push("/auth")},[s,n,l]),n)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin ml-2",children:(0,r.jsx)(C.A,{size:26,strokeWidth:1})})}):s?(0,r.jsx)(r.Fragment,{children:t}):null};var S=s(7058),E=s(4595);let I=e=>{let[t,s]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{if(!e)return;let t=(0,S.P)((0,S.rJ)(E.db,"entries"),(0,S._M)("userId","==",e)),r=(0,S.aQ)(t,e=>{s(e.docs.map(e=>({id:e.id,...e.data()}))),n(!1)});return()=>r()},[e]),{entries:t,loading:r,addEntry:async t=>{try{await (0,S.gS)((0,S.rJ)(E.db,"entries"),{...t,userId:e,createdAt:new Date().toISOString()})}catch(e){throw console.error("Error adding entry:",e),e}},deleteEntry:async e=>{try{await (0,S.kd)((0,S.H9)(E.db,"entries",e))}catch(e){throw console.error("Error deleting entry:",e),e}}}},O=e=>{let[t,s]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{if(!e)return;let t=(0,S.P)((0,S.rJ)(E.db,"products"),(0,S._M)("userId","==",e)),r=(0,S.aQ)(t,e=>{s(e.docs.map(e=>({id:e.id,...e.data()}))),n(!1)});return()=>r()},[e]),{products:t,loading:r,addProduct:async t=>{try{await (0,S.gS)((0,S.rJ)(E.db,"products"),{...t,userId:e,createdAt:new Date().toISOString()})}catch(e){throw console.error("Error adding product:",e),e}},deleteProduct:async e=>{try{await (0,S.kd)((0,S.H9)(E.db,"products",e))}catch(e){throw console.error("Error deleting product:",e),e}}}},P=(0,l.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function D(){let{user:e,logout:t}=(0,k.Z)(),{products:s,addProduct:a,deleteProduct:n,loading:l}=O(null==e?void 0:e.uid),{entries:c,addEntry:i,deleteEntry:d,loading:o}=I(null==e?void 0:e.uid);return(0,r.jsx)(A,{children:(0,r.jsxs)("div",{className:"grid grid-rows-[10px_1fr_55px] items-center justify-items-center min-h-screen font-[family-name:var(--font-geist-sans)]",children:[(0,r.jsxs)("main",{className:"flex flex-col row-start-2 items-center sm:items-start",children:[(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("p",{children:["Вітаю, ",null==e?void 0:e.email]})}),l||o?"Loading...":(0,r.jsx)(f,{products:s,entries:c,onAddProduct:a,onAddEntry:i,onDeleteProduct:n,onDeleteEntry:d})]}),(0,r.jsx)("footer",{className:"row-start-3 flex gap-6 flex-wrap items-center justify-center",children:(0,r.jsxs)("button",{onClick:t,className:"btn btn-sm",children:["Вийти",(0,r.jsx)(P,{size:16})]})})]})})}},3679:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(2115),a=s(399),n=s(4595);let l=()=>{let[e,t]=(0,r.useState)(null),[s,l]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=(0,a.hg)(n.j,e=>{t(e),l(!1)});return()=>e()},[]),{user:e,loading:s,signInWithGoogle:async()=>{try{return(await (0,a.df)(n.j,n.h)).user}catch(e){throw console.error("Error signing in with Google:",e),e}},logout:()=>(0,a.CI)(n.j)}}},4595:(e,t,s)=>{"use strict";s.d(t,{db:()=>d,h:()=>i,j:()=>c});var r=s(9904),a=s(399),n=s(7058);let l=(0,r.Wp)({apiKey:"AIzaSyCFQPz1JQSGn8M2QdVkxA8tWqQvQT0QYcA",authDomain:"tracking-kcal.firebaseapp.com",projectId:"tracking-kcal",storageBucket:"tracking-kcal.firebasestorage.app",messagingSenderId:"959211134233",appId:"1:959211134233:web:621d0a43eeeb642a347988"}),c=(0,a.xI)(l),i=new a.HF,d=(0,n.aU)(l)},9616:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>c,Z:()=>i});var r=s(5155),a=s(2115),n=s(3679);let l=(0,a.createContext)(null),c=e=>{let{children:t}=e,s=(0,n.A)();return(0,r.jsx)(l.Provider,{value:s,children:t})},i=()=>{let e=(0,a.useContext)(l);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,882,459,441,517,358],()=>t(2785)),_N_E=e.O()}]);